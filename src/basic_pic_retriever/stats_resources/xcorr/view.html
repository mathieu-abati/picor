<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="title" content="Results" />
<script type="text/javascript" src="infos.js"></script>
<script type="text/javascript">
function handle_keypress(e)
{
	var unicode=e.keyCode? e.keyCode : e.charCode;
	switch (unicode) {
		case 8:
			cur_image_index = better_image_index;
			break;
		case 37:
			if (typeof images_list[cur_image_index-1] != "undefined")
				cur_image_index--;
			break;
		case 39:
			if (typeof images_list[cur_image_index+1] != "undefined")
				cur_image_index++;
			break;
	}
	document.getElementById("better_image").src =
		images_list[cur_image_index];
	var relative_id = cur_image_index - better_image_index;
	if (relative_id < 0)
		document.getElementById("relative_id").innerHTML = relative_id;
	else if (relative_id > 0)
		document.getElementById("relative_id").innerHTML = "+"+relative_id;
	else
		document.getElementById("relative_id").innerHTML = "";
}

function disp_ref_image_size()
{
	document.getElementById("ref_image_size").innerHTML =
		"(" + document.getElementById("ref_image").naturalWidth + "x"
		+ document.getElementById("ref_image").naturalHeight + ")";
}

function disp_better_image_size()
{
	document.getElementById("better_image_size").innerHTML =
		"(" + document.getElementById("better_image").naturalWidth + "x"
		+ document.getElementById("better_image").naturalHeight + ")";
}

var better_image_index = images_list.indexOf(better_image);
var cur_image_index = better_image_index;
</script>
	</head>
	<body>
		<p>
			Better r=<span id="better_r"></span>
			&nbsp;&nbsp;&nbsp;&nbsp;
			Cross-correlation done in <span id="spent_time"></span>s
			on <span id="images_count"></span> images
			&nbsp;&nbsp;&nbsp;&nbsp;
			<span id="date"></span>
		</p>
		<div style="display: inline-block; width: 49%; float: left; padding-right: 5px">
			<strong>Reference image <span id="ref_image_size"></span></strong>
			<p>&nbsp;</p>
			<img id="ref_image" alt="reference" title="Reference image"
				onload="disp_ref_image_size()" style="width: 100%" />
		</div>
		<div style="display: inline-block; width: 49%; float: left; padding-left: 5px">
			<strong>Better match <span id="better_image_size"></span > <span id="relative_id"></span></strong>
			<p>Press &#8678; or &#8680; to navigate in collection, and backspace to return to better match</p>
			<img id="better_image" alt="match" title="Better match"
				onload="disp_better_image_size()" style="width: 100%" />
		</div>
		<br />
		<img src="plot.png" alt="xcorr" title="Cross-correlation" />
		<br />
		<img src="plot_zoom.png" alt="xcorr_zoom" title="Cross-correlation: zoom" />
<script type="text/javascript">
document.getElementById("ref_image").src = ref_image;
document.getElementById("better_image").src = better_image;
document.getElementById("better_r").innerHTML = better_coeff;
document.getElementById("spent_time").innerHTML = spent_time;
document.getElementById("images_count").innerHTML = images_count;
let date_obj = new Date(date * 1000);
let local_date = date.toLocaleString();
document.getElementById("date").innerHTML = local_date;
document.body.addEventListener("keyup", handle_keypress);
</script>
	</body>
</html>
